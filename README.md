
# MNIST 手写数字识别项目

本项目使用 TensorFlow 构建并训练一个多层感知机（MLP）模型，用于识别 MNIST 手写数字。包含完整的训练、测试和预测流程，并支持可视化结果。

---

## 项目结构

```
.
├── MNIST_data/            # 存放 MNIST 数据集（自动下载）
├── pictures/              # 保存实验结果图（如预测对比图）
├── mnist_models/          # 保存训练好的模型权重（.h5 文件）
├── predictionsonflow.py   # 预测脚本：加载模型并对指定图像进行预测
└── train(tensorflow).py   # 训练脚本：训练模型并保存权重
```

---

## 环境依赖

- **Python 3.6+**
- **TensorFlow 2.x**
- **NumPy**
- **Matplotlib**

安装依赖：
```bash
pip install tensorflow numpy matplotlib
```

---

## 快速开始

### 1. 训练模型
运行训练脚本：
```bash
python train(tensorflow).py
```
- **输入需要训练的迭代次数**（例如 `5000`）。
- 每 1000 次迭代输出训练损失和准确率。
- 训练完成后，模型权重将保存至 `mnist_models/model.weights.h5`。
- 测试集准确率会在训练结束后自动计算并显示。

### 2. 使用模型进行预测
运行预测脚本：
```bash
python predictionsonflow.py
```
- **输入图像编号**（0-9999，对应测试集中的 10000 张图像）。
- 程序会显示图像、预测值和真实标签，并输出预测概率分布。
- 输入 `-1` 退出程序。

---

## 功能特性

### 模型结构
- **输入层**：784 个神经元（对应 28x28 图像）。
- **隐藏层**：128 个神经元（ReLU 激活） → 64 个神经元（ReLU 激活）。
- **输出层**：10 个神经元（对应 0-9 分类）。

### 优化策略
- **权重初始化**：使用 He 初始化（缓解梯度消失问题）。
- **动态学习率**：指数衰减学习率（初始值 0.001，每 1000 步衰减 4%）。
- **损失函数**：分类交叉熵（Categorical Crossentropy）。

### 数据管理
- **自动下载数据集**：首次运行脚本时自动下载 MNIST 数据集至 `MNIST_data/`。
- **权重保存与加载**：支持从 `mnist_models/` 加载预训练权重进行预测。

---

## 结果示例

### 训练输出
```
第 1000 次训练 损失值: 0.123456 训练准确率: 96.500%
平均测试准确率：97.850%
```

### 预测输出
```
预测概率分布：[0.01, 0.02, ..., 0.85, ...]
预测值: 7, 标签: 7, 预测正确！
```


---

## 注意事项

1. **数据集下载**：首次运行时会自动下载 MNIST 数据集（约 15MB），保存在 `MNIST_data/`。
2. **中文显示问题**：若 Matplotlib 中文标签乱码，请确保系统支持 `SimHei` 字体（仅影响显示）。
3. **权重保存路径**：训练完成后，请勿删除 `mnist_models/` 目录，否则预测脚本无法加载模型。
4. **输入范围限制**：预测脚本仅支持输入 0-9999 的整数编号，输入其他值会提示错误。

---

